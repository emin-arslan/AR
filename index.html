<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR AR Model Viewer</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.min.js"></script>
</head>
<body>
  <model-viewer 
    id="ar-model"
    src="https://modelviewer.dev/shared-assets/models/Astronaut.glb" 
    alt="Astronaut Model"
    ar
    ar-modes="webxr scene-viewer quick-look" 
    camera-controls 
    auto-rotate 
    style="width: 100%; height: 500px;">
    <button slot="ar-button" id="ar-button">View in your space</button>
  </model-viewer>

  <script>
    // QR parametresini kontrol eden fonksiyon
    function checkQREntry() {
      // URL'den 'qr' parametresini al
      const urlParams = new URLSearchParams(window.location.search);
      const isQREntry = urlParams.get('qr') === 'true';

      if (isQREntry) {
        const modelViewer = document.getElementById('ar-model');
        
        // AR butonuna tıklama işlemini simüle et
        setTimeout(() => {
          // Bazı model viewer'lar için farklı AR başlatma metodları
          if (modelViewer.enterAR) {
            modelViewer.enterAR();
          } else {
            const arButton = modelViewer.querySelector('[slot="ar-button"]');
            if (arButton) {
              arButton.click();
            }
          }
        }, 1000); // Küçük bir gecikme ekledik
      }
    }

    // Sayfa yüklendiğinde QR kontrolünü yap
    window.addEventListener('load', checkQREntry);
  </script>
</body>
</html>